this.BX=this.BX||{},function(e){"use strict";var t=function(){function e(){babelHelpers.classCallCheck(this,e),babelHelpers.defineProperty(this,"links",[]),babelHelpers.defineProperty(this,"popup",null),babelHelpers.defineProperty(this,"video",null)}return babelHelpers.createClass(e,[{key:"init",value:function(e){var t=this;void 0!==window.frameCacheVars?BX.addCustomEvent("onFrameDataReceived",(function(i){return t.initItems(e)})):BX.ready((function(i){return t.initItems(e)}))}},{key:"initItems",value:function(e){this.links=document.querySelectorAll(e+"[data-dzenId]");for(var t=0,i=this.links.length;t<i;++t)this.links[t].getAttribute("data-dzenEnabled")||(this.links[t].addEventListener("click",this.clickHandler.bind(this),!0),this.links[t].setAttribute("data-dzenEnabled",1))}},{key:"clickHandler",value:function(e){e.stopPropagation(),e.preventDefault(),this.renderPopup(),this.renderVideo(e.target.getAttribute("data-dzenId"))}},{key:"closeHandler",value:function(e){e.stopPropagation(),e.preventDefault(),this.removePopup(),this.removeVideo()}},{key:"removePopup",value:function(){this.popup&&this.popup.classList.add("vs-dzen-hide")}},{key:"removeVideo",value:function(){this.video&&(this.video.parentNode.removeChild(this.video),this.video=null)}},{key:"renderPopup",value:function(){if(this.popup)this.popup.classList.remove("vs-dzen-hide");else{this.popup=document.createElement("div"),this.popup.className="vs-dzen-popup",this.popup.addEventListener("click",this.closeHandler.bind(this),!0);var e=document.createElement("div");e.className="vs-dzen-close",this.popup.append(e),document.body.append(this.popup)}}},{key:"calcSize",value:function(){var e=this.popup.clientWidth,t=this.popup.clientHeight,i={width:e>1920?1920:e,height:0};return i.height=Math.floor(.5625*i.width),i.height>t&&(i.width=Math.floor(t/.5625)),i}},{key:"renderVideo",value:function(e){var t=this.calcSize();this.video=document.createElement("div"),this.video.className="vs-dzen-video",this.video.innerHTML='<iframe width="'+t.width+'" height="'+t.height+'" src="https://dzen.ru/embed/'+e+'?from_block=partner&from=zen&backoffice=1&autoplay=1&tv=0" allow="au2toplay; fullscreen; accelerometer; gyroscope; picture-in-picture; encrypted-media" frameBorder="0" scrolling="no" allowFullScreen="yes"></iframe>',this.popup.append(this.video)}}]),e}();e.DzenLinks=t}(this.BX.Vasoft=this.BX.Vasoft||{});
//# sourceMappingURL=vasoft-dzen.bundle.js.map
